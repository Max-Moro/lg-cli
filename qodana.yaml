# Qodana Configuration for Python Project
# Documentation: https://www.jetbrains.com/help/qodana/qodana-yaml.html

version: "1.0"

# Use the Community Edition linter for Python
linter: qodana-python-community

# Bootstrap command to install dependencies before analysis
# This ensures Qodana can resolve all imports and type hints
bootstrap: |
  echo "Installing project dependencies..."
  python -m pip install --upgrade pip
  python -m pip install -e .[dev]
  echo "Dependencies installed successfully"

# Inspection profile (custom: includes test code in analysis scope)
profile:
  path: .idea/inspectionProfiles/qodana.recommended.with-tests.yaml

# Exclude inspections and paths
exclude:
  # Exclude all inspections from generated files
  - name: All
    paths:
      - .qodana
      - lg/diag/diag_report_schema.py
      - lg/stats/report_schema.py

  # Disable harmful/noisy inspections globally
  # PyMethodMayBeStaticInspection: Suggests making methods static - harmful, breaks API consistency
  - name: PyMethodMayBeStaticInspection

  # PyShadowingNamesInspection: Variable shadowing - prevents elegant short names
  - name: PyShadowingNamesInspection

  # PyUnreachableCodeInspection: False positives on type narrowing, Literal exhaustion, Optional handling
  - name: PyUnreachableCodeInspection

  # PyBroadExceptionInspection: Sometimes reasonable, but too many false positives
  - name: PyBroadExceptionInspection

  # PyPep8NamingInspection: Migration classes intentionally use underscore prefix for privacy
  - name: PyPep8NamingInspection
    paths:
      - lg/migrate/migrations

  # PyTypeHintsInspection: New in Qodana 252.28456.347 - incorrectly flags valid type hints like "-> None"
  - name: PyTypeHintsInspection

  # PyClassHasNoInitInspection: New in Qodana 252.28456.347 - incorrectly flags @dataclass without __init__
  - name: PyClassHasNoInitInspection

  # This inspection is not yet operational in Qodana. Adding 'ABC' to the signature does not fix it.
  - name: PyAbstractClassInspection

  # PyProtectedMemberInspection: Tests intentionally access internal APIs for verification
  - name: PyProtectedMemberInspection
    paths:
      - tests

  # Golden test fixtures â€” reference code samples for all supported languages.
  # They are not production or test code; they intentionally contain quality issues.
  - name: All
    paths:
      - tests/adapters/c/goldens
      - tests/adapters/cpp/goldens
      - tests/adapters/go/goldens
      - tests/adapters/java/goldens
      - tests/adapters/javascript/goldens
      - tests/adapters/kotlin/goldens
      - tests/adapters/python/goldens
      - tests/adapters/rust/goldens
      - tests/adapters/scala/goldens
      - tests/adapters/typescript/goldens