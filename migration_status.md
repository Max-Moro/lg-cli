# Test Infrastructure Refactoring Status

## –¶–µ–ª—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
–ü—Ä–∏–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –ø—Ä–∏–Ω—Ü–∏–ø–æ–º DRY, —É–±—Ä–∞–≤ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ `conftest.py` —Ñ–∞–π–ª–∞–º–∏.

## –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã —Ç–µ—Å—Ç–æ–≤:
1. **tests/** (–∫–æ—Ä–Ω–µ–≤–æ–π) - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (lctx*, write, run_cli, jload, stub_tokenizer)
2. **tests/adapters/** - –±–∞–∑–æ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã (is_tree_sitter_available, create_temp_file)
3. **tests/adapters/python/** - Python-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∞–¥–∞–ø—Ç–µ—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã (make_adapter, fixtures –¥–ª—è golden)  
4. **tests/adapters/typescript/** - TypeScript-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∞–¥–∞–ø—Ç–µ—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã (make_adapter, fixtures)
5. **tests/markdown/** - Markdown –∞–¥–∞–ø—Ç–µ—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã (adapter helper)
6. **tests/adaptive/** - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (—Ä–µ–∂–∏–º—ã, —Ç–µ–≥–∏, —Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
7. **tests/cdm/** - cross-directory modules (–º–µ–∂–∫–∞—Ç–∞–ª–æ–≥–æ–≤—ã–µ –º–æ–¥—É–ª–∏)  
8. **tests/common_placeholders/** - –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã —Å–µ–∫—Ü–∏–π –∏ —à–∞–±–ª–æ–Ω–æ–≤
9. **tests/md_placeholders/** - md-–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã (300 —Å—Ç—Ä–æ–∫, –¢–Ø–ñ–ï–õ–û–ï –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï —Å common_placeholders)

## –ê–Ω–∞–ª–∏–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã:
- `write()` - –≤ 5+ –ø–∞–∫–µ—Ç–∞—Ö (–∫–æ—Ä–Ω–µ–≤–æ–π, adaptive, common_placeholders, md_placeholders) 
- `create_template()` - –≤ adaptive, common_placeholders, md_placeholders  
- `render_template()` - –≤ common_placeholders, md_placeholders (–ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ!)
- `make_run_options()` - –≤ adaptive, common_placeholders, md_placeholders
- `create_basic_lg_cfg()` / `create_sections_yaml()` - —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö
- `make_adapter()` - –≤ adapters/python –∏ adapters/typescript (–ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ)
- `create_temp_file()` - –≤ adapters/ (–¥—É–±–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å write)
- `write_markdown()` - —Ç–æ–ª—å–∫–æ –≤ md_placeholders, –Ω–æ –º–æ–≥–ª–∞ –±—ã –±—ã—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã:
- –ü—Ä–æ–µ–∫—Ç—ã —Å –±–∞–∑–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π: `basic_project`, `adaptive_project`, `md_project`
- –§–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã: `federated_project` (–≤ adaptive –∏ common_placeholders)
- –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã: `multilang_project`, `fragments_project`

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- `ModeConfig`, `ModeSetConfig`, `TagConfig`, `TagSetConfig` - —Ç–æ–ª—å–∫–æ –≤ adaptive
- –†–∞–∑–ª–∏—á–Ω—ã–µ —Ö–µ–ª–ø–µ—Ä—ã –¥–ª—è YAML - –≤–æ –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–∞—Ö

## –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
- [x] –°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—É—Å–Ω—ã–π —Ñ–∞–π–ª
- [ ] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ conftest.py
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤—Å–µ—Ö conftest.py
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å

### –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- [x] –°–æ–∑–¥–∞—Ç—å `tests/infrastructure/` —Å –±–∞–∑–æ–≤—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏
- [x] –í—ã–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã (write, yaml helpers) 
- [x] –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [x] –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –±–∏–ª–¥–µ—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤

**–°–æ–∑–¥–∞–Ω—ã –º–æ–¥—É–ª–∏:**
- `tests/infrastructure/__init__.py` - –≥–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å —ç–∫—Å–ø–æ—Ä—Ç–∞
- `tests/infrastructure/file_utils.py` - —É—Ç–∏–ª–∏—Ç—ã —Ñ–∞–π–ª–æ–≤ (write, write_source_file, write_markdown, etc.)
- `tests/infrastructure/rendering_utils.py` - —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ (render_template, make_run_options, make_engine)  
- `tests/infrastructure/config_builders.py` - YAML –∫–æ–Ω—Ñ–∏–≥–∏ (create_sections_yaml, create_modes_yaml, etc.)
- `tests/infrastructure/adapter_utils.py` - –∞–¥–∞–ø—Ç–µ—Ä—ã (make_*_adapter, tree-sitter utils)
- `tests/infrastructure/fixtures.py` - pytest —Ñ–∏–∫—Å—Ç—É—Ä—ã (tmp_project, make_run_context)
- `tests/infrastructure/project_builders.py` - –±–∏–ª–¥–µ—Ä—ã –ø—Ä–æ–µ–∫—Ç–æ–≤ (ProjectBuilder, create_*_project)

### –≠—Ç–∞–ø 3: –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ –ø–∞–∫–µ—Ç–∞–º
- [x] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å tests/adaptive/ - ‚úÖ –ó–ê–í–ï–†–®–ï–ù! (89 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- [x] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å tests/cdm/ - ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω (11 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- [x] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å tests/common_placeholders/ - ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω (68 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- [x] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å tests/md_placeholders/ - ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω (99 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)

### –≠—Ç–∞–ø 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
- [ ] –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
- [ ] –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: üéâ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê! üéâ

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
- –°–æ–∑–¥–∞–Ω —Å—Ç–∞—Ç—É—Å–Ω—ã–π —Ñ–∞–π–ª  
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- –°–æ–∑–¥–∞–Ω—ã —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤—Å–µ—Ö conftest.py (.backup)
- –ó–∞–ø—É—â–µ–Ω—ã —Ç–µ—Å—Ç—ã - –≤—Å–µ 775 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç ‚úÖ
- –°–æ–∑–¥–∞–Ω–∞ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ tests/infrastructure/
- ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –í–°–ï–• 8 –ø–∞–∫–µ—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –≤—Å–µ 775 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏! 
- üéâ **–†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!**

### –†–∞–±–æ—á–∏–µ —Ç–µ—Å—Ç—ã:
- ‚úÖ –í–°–ï –ü–ê–ö–ï–¢–´ –ú–ò–ì–†–ò–†–û–í–ê–ù–´! –í—Å–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Ç–µ—Å—Ç—ã:
  - adapters/*: 184 —Ç–µ—Å—Ç–∞ ‚úÖ
  - markdown: –≤–∫–ª—é—á–µ–Ω –≤ adapter —Ç–µ—Å—Ç—ã ‚úÖ  
  - cdm: 11 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
  - md_placeholders: 99 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
  - common_placeholders: 68 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
  - adaptive: 89 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
  - –ò–¢–û–ì–û: ~451 –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ ‚úÖ

### –°–ª–æ–º–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã: 
- –ü–æ–∫–∞ –Ω–µ—Ç —Å–ª–æ–º–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

### –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
1. ‚úÖ tests/markdown/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç make_markdown_adapter)
2. ‚úÖ tests/adapters/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç infrastructure utils) 
3. ‚úÖ tests/adapters/python/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç make_python_adapter*)
4. ‚úÖ tests/adapters/typescript/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç make_typescript_adapter*)
5. ‚úÖ tests/cdm/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç infrastructure, 11 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
6. ‚úÖ tests/md_placeholders/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç create_md_project, 99 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
7. ‚úÖ tests/common_placeholders/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–¢–Ø–ñ–ï–õ–û–ï –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ, 68 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)
8. ‚úÖ tests/adaptive/conftest.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω (–°–ê–ú–´–ô –°–õ–û–ñ–ù–´–ô –ü–ê–ö–ï–¢ –∑–∞–≤–µ—Ä—à–µ–Ω, 89 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)

### –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã:
1. ‚úÖ **–ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!** –í—Å–µ 8 –ø–∞–∫–µ—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
2. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ tests/infrastructure/ 
3. ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –º–∞—Å—Å–∏–≤–Ω–æ–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
4. ‚úÖ –í—Å–µ 451 –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç

### –ß—Ç–æ –±—ã–ª–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:
- **–ü—Ä–∏–Ω—Ü–∏–ø DRY —Å–æ–±–ª—é–¥–µ–Ω**: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –º–µ–∂–¥—É conftest.py —Ñ–∞–π–ª–∞–º–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ
- **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: 7 –º–æ–¥—É–ª–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã**: ModeConfig/TagConfig –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è adaptive —Ç–µ—Å—Ç–æ–≤  
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç –ª–µ–≥–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É