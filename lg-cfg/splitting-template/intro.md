# Задача по разделению шаблонизатора на модули

## Введение

В инструменте LG конечные контексты представляются в виде Markdown формата и могут собираться из множества источников по определенным правилам. По этой причине внутри LG используется довольно развитый движок шаблонизации на основе AST-based подхода — `lg/template/`.

Данный движок состоит из довольно традиционных модулей для AST-based систем:
- `nodes.py`
- `lexer.py`
- `parser.py`
- `evaluator.py`
- `resolver.py`
- `processor.py`

Так и исключительно из модулей со специфичной бизнес логикой:
- `virtual_sections.py`
- `heading_context.py`
- `context.py`
- `common.py`

На начальных этапах разработки такое разделение было логичным, но теперь, при росте функциональных возможностей его уже не достаточно.

Если рассматривать не внутреннюю математику, а именно бизнес функции движка шаблонизации, то можно выделить три крупных функциональных блока.

### Блок №1. Обработка плейсхолдеров секций и родных для LG шаблонов

- вставка секций — `${my-section}`
- вставка шаблонов — `${tpl:common/intro}`
- вставка контекста — `${ctx:api/review}`
- адресные ссылки и работа со скоупами

### Блок №2. Работа с условными конструкциями и операторами для адаптивных возможностей

- Условные конструкции
- Операторы условий
- Режимные блоки
- Комментарии

### Блок №3. Вставка не родных для LG Markdown-фрагментов через MD-плейсхолдер

Все возможности плейсхолдера `${md:…}`.
