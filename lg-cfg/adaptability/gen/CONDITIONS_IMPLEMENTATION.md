# –°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π - –ò—Ç–µ—Ä–∞—Ü–∏—è 2

## –û–±–∑–æ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –¥–ª—è Listing Generator —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–ú–æ–¥–µ–ª—å AST** (`lg/conditions/model.py`) - –£–∑–ª—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –¥–ª—è —É—Å–ª–æ–≤–∏–π
- **–õ–µ–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä** (`lg/conditions/lexer.py`) - –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ —É—Å–ª–æ–≤–∏–π
- **–ü–∞—Ä—Å–µ—Ä** (`lg/conditions/parser.py`) - –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
- **–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å** (`lg/conditions/evaluator.py`) - –û—Ü–µ–Ω–∫–∞ AST –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

### üìù –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- `tag:name` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ç–µ–≥–∞
- `TAGSET:set_name:tag_name` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –Ω–∞–±–æ—Ä–∞ —Ç–µ–≥–æ–≤
- `scope:local/parent` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–∫–æ—É–ø–∞
- `NOT condition` - –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ
- `condition1 AND condition2` - –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –ò
- `condition1 OR condition2` - –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –ò–õ–ò  
- `(condition)` - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å –∫—Ä—É–≥–ª—ã–º–∏ —Å–∫–æ–±–∫–∞–º–∏

### üéØ –õ–æ–≥–∏–∫–∞ —É—Å–ª–æ–≤–∏–π TAGSET
–û—Å–æ–±–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è —É—Å–ª–æ–≤–∏–π `TAGSET:set_name:tag_name`:
- **–ò—Å—Ç–∏–Ω–Ω–æ**, –µ—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω —Ç–µ–≥ –∏–∑ –Ω–∞–±–æ—Ä–∞ –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω
- **–ò—Å—Ç–∏–Ω–Ω–æ**, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–µ–≥ –∞–∫—Ç–∏–≤–µ–Ω —Å—Ä–µ–¥–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–≥–æ–≤ –Ω–∞–±–æ—Ä–∞
- **–õ–æ–∂–Ω–æ** –≤–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö
- **–ò—Å—Ç–∏–Ω–Ω–æ** –¥–ª—è –ø—É—Å—Ç—ã—Ö –∏–ª–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–∞–±–æ—Ä–æ–≤

### üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å `RunContext` —á–µ—Ä–µ–∑ `ConditionContext`
- –ü—É–±–ª–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `evaluate_condition_string(condition_str, context)`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **53 –º–æ–¥—É–ª—å–Ω—ã—Ö –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞**
- **95% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**
- –¢–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: –ª–µ–∫—Å–µ—Ä, –ø–∞—Ä—Å–µ—Ä, –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

### üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
- –ö–æ—Ä–æ—Ç–∫–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ –¥–ª—è –±—É–ª–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ —à–∞–±–ª–æ–Ω—ã –∏ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —É—Å–ª–æ–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ YAML –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤.

### üìñ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```python
from lg.conditions import evaluate_condition_string
from lg.run_context import ConditionContext

context = ConditionContext(
    active_tags={"python", "api"},
    tagsets={"language": {"python", "javascript"}},
    current_scope="local"
)

result = evaluate_condition_string("tag:python AND TAGSET:language:python", context)
# result = True
```

## –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
lg/conditions/
‚îú‚îÄ‚îÄ __init__.py          # –≠–∫—Å–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ model.py            # AST —É–∑–ª—ã —É—Å–ª–æ–≤–∏–π
‚îú‚îÄ‚îÄ lexer.py            # –¢–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä
‚îú‚îÄ‚îÄ parser.py           # –ü–∞—Ä—Å–µ—Ä —É—Å–ª–æ–≤–∏–π  
‚îî‚îÄ‚îÄ evaluator.py        # –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å —É—Å–ª–æ–≤–∏–π

tests/test_conditions/
‚îú‚îÄ‚îÄ test_lexer.py       # –¢–µ—Å—Ç—ã –ª–µ–∫—Å–µ—Ä–∞
‚îú‚îÄ‚îÄ test_parser.py      # –¢–µ—Å—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞  
‚îú‚îÄ‚îÄ test_evaluator.py   # –¢–µ—Å—Ç—ã –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—è
‚îî‚îÄ‚îÄ test_integration.py # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

–°–∏—Å—Ç–µ–º–∞ —É—Å–ª–æ–≤–∏–π –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –∏—Ç–µ—Ä–∞—Ü–∏—è—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!