# –ö–æ–¥—Ä–µ–≤—å—é: Literal Optimization v2

**–î–∞—Ç–∞:** 2025-12-04
**–†–µ–≤—å—é–µ—Ä:** Claude (AI-–∞–≥–µ–Ω—Ç –¥–ª—è –∫–æ–¥—Ä–µ–≤—å—é)
**–û–±–ª–∞—Å—Ç—å:** –ü–æ–ª–Ω–æ–µ —Ä–µ–≤—å—é —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ literals_v2 (–º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ 4 —è–∑—ã–∫–∞: Python, JS, TS, Java)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–û–î–û–ë–†–ï–ù–û**
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-04 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã 1 –∏ 2

---

## –†–µ–∑—é–º–µ

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ literals_v2 —É—Å–ø–µ—à–Ω–æ —Ä–µ—à–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã:

‚úÖ **–î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏:**
- –Ø–∑—ã–∫–æ-–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–æ–µ —è–¥—Ä–æ (100% - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 2025-12-04)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 2025-12-04)
- –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã 50-150 —Å—Ç—Ä–æ–∫ vs 300+ –≤ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏)
- –ì–∏–±–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ (END, MIDDLE_COMMENT, INLINE)
- –ï–¥–∏–Ω—ã–π —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω (—É—Å—Ç—Ä–∞–Ω–µ–Ω—ã —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ö—É–∫–æ–≤)
- –î–≤—É—Ö–ø—Ä–æ—Ö–æ–¥–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å –∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º—ã–º–∏ –ø—Ä–∞–≤–∫–∞–º–∏
- DFS-–æ–±—Ä–µ–∑–∫–∞ –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä

‚ö†Ô∏è **–û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚úÖ ~~1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (—è–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ –≤ handler)~~ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- ‚úÖ ~~1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞)~~ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- 2 —Å—Ä–µ–¥–Ω–µ–π –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- 5 —É–ª—É—á—à–µ–Ω–∏–π –Ω–∏–∑–∫–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** **B+ ‚Üí A- ‚Üí A (–û—Ç–ª–∏—á–Ω–æ, –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã 1-2 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –ú–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —è–∑—ã–∫–æ–≤. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã 3-6 –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º —Ä–µ–ª–∏–∑–æ–º.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#1-–æ–±–∑–æ—Ä-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
2. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞](#2-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–∏-–∫–∞—á–µ—Å—Ç–≤–æ-–∫–æ–¥–∞)
3. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã](#3-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã)
4. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#4-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
5. [–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–∏–≥—Ä–∞—Ü–∏–∏](#5-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å-–∫-–º–∏–≥—Ä–∞—Ü–∏–∏)

---

## 1. –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞

```
lg/adapters/optimizations/literals_v2/
‚îú‚îÄ‚îÄ categories.py     (170 —Å—Ç—Ä–æ–∫) - ‚úÖ –ß–∏—Å—Ç—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤
‚îú‚îÄ‚îÄ descriptor.py     (67 —Å—Ç—Ä–æ–∫)  - ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ parser.py         (382 —Å—Ç—Ä–æ–∫–∏) - ‚úÖ –ï–¥–∏–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ selector.py       (554 —Å—Ç—Ä–æ–∫–∏) - ‚ö†Ô∏è –í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤ DFS
‚îú‚îÄ‚îÄ formatter.py      (628 —Å—Ç—Ä–æ–∫) - ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (~300 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ handler.py        (703 —Å—Ç—Ä–æ–∫–∏) - üî¥ –Ø–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ core.py           (310 —Å—Ç—Ä–æ–∫) - ‚úÖ –ß–∏—Å—Ç–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

**–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:** ‚úÖ **–û–¢–õ–ò–ß–ù–û–ï**
- –ü–∞–π–ø–ª–∞–π–Ω Parser ‚Üí Selection ‚Üí Formatting —á–∏—Å—Ç—ã–π
- –ù–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ß—ë—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –º–æ–¥—É–ª–µ–π

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:**
```python
# selector.py - –Ω–µ –∑–Ω–∞–µ—Ç –æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
class BudgetSelector:
    def select_first(self, elements, budget) -> Selection:
        # –ß–∏—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞

# formatter.py - –Ω–µ –∑–Ω–∞–µ—Ç –æ –≤—ã–±–æ—Ä–µ
class ResultFormatter:
    def format(self, parsed, selection) -> FormattedResult:
        # –ß–∏—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

### 1.2 –Ø–∑—ã–∫–æ-–∞–≥–Ω–æ—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í –û–°–ù–û–í–ù–û–ú –î–û–°–¢–ò–ì–ù–£–¢–û** (98%)

**–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ:**
- –ù–µ—Ç –∏–º–ø–æ—Ä—Ç–æ–≤ —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π –≤ —è–¥—Ä–µ
- –°–∏—Å—Ç–µ–º–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞
- –°—Ç–∏–ª—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –±–µ—Ä—ë—Ç—Å—è –∏–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ - handler.py:539-550:**
```python
def _get_active_interpolation_markers(self, parsed):
    for marker in markers:
        prefix, opening, closing = marker
        if prefix:
            active_markers.append(marker)
        else:
            # üî¥ –ü–†–û–ë–õ–ï–ú–ê: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ —è–∑—ã–∫–∞
            if self.language == "python":
                if 'f' in opening_lower:
                    active_markers.append(marker)
            elif self.language == "rust":
                pass  # Skip
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:**
- –ù–∞—Ä—É—à–∞–µ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø: "—è–¥—Ä–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –∑–Ω–∞—Ç—å –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —è–∑—ã–∫–∞—Ö"
- –¢—Ä–µ–±—É–µ—Ç –æ—Ç handler –∑–Ω–∞–Ω–∏—è –æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–µ Python/Rust
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞ —Å–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–µ–π —Ç—Ä–µ–±—É–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ handler
- –ù–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∑–Ω–∞–Ω–∏—è –æ —è–∑—ã–∫–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å callback –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ LiteralPattern:
```python
# –í categories.py
@dataclass
class LiteralPattern:
    interpolation_active: Optional[Callable[[str, str], bool]] = None

# –í python/literals_v2.py - —è–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–µ
def is_f_string(opening: str, content: str) -> bool:
    return 'f' in opening.lower()

PYTHON_STRING = LiteralPattern(
    interpolation_markers=[("", "{", "}")],
    interpolation_active=is_f_string,  # –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ!
)
```

### 1.3 –í—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–û–¢–õ–ò–ß–ù–ê–Ø**

Dataclass `LiteralPattern` —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ —Å–ª—É—á–∞–∏:

**–ü—Ä–∏–º–µ—Ä - Java Map.of —Å —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π –∫–æ—Ä—Ç–µ–∂–µ–π:**
```python
JAVA_MAP_OF = LiteralPattern(
    category=LiteralCategory.FACTORY_CALL,
    tree_sitter_types=["method_invocation"],
    wrapper_match=r"Map\.of$",      # –û—Ç–ª–∏—á–∏—Ç—å –æ—Ç Map.ofEntries
    tuple_size=2,                    # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –ø–∞—Ä—ã –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ!
    placeholder_position=PlaceholderPosition.MIDDLE_COMMENT,
    priority=20,
)
```

–≠—Ç–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω `Map.of(k1, v1, k2, v2)` –±–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–¥–∞.

**–ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π (–≤—ã–∑—ã–≤–∞–µ–º—ã–µ `opening`/`closing`)
- ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏ —Ñ–∞–±—Ä–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ (`wrapper_match`)
- ‚úÖ –°–µ–º–∞–Ω—Ç–∏–∫–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∫–æ—Ä—Ç–µ–∂–µ–π (`tuple_size`)
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤

### 1.4 –ö–∞—á–µ—Å—Ç–≤–æ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π

**Selection vs DFSSelection:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –û–ë–™–ï–î–ò–ù–ï–ù–ò–ï**

90% –ø–æ–ª–µ–π –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è:

```python
@dataclass
class Selection:
    kept_elements: List[Element]      # –î—É–±–ª–∏–∫–∞—Ç
    removed_elements: List[Element]   # –î—É–±–ª–∏–∫–∞—Ç
    total_count: int                  # –î—É–±–ª–∏–∫–∞—Ç
    tokens_kept: int                  # –î—É–±–ª–∏–∫–∞—Ç
    tokens_removed: int               # –î—É–±–ª–∏–∫–∞—Ç
    placeholder_index: int = -1       # –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ

@dataclass
class DFSSelection:
    kept_elements: List[Element]      # –î—É–±–ª–∏–∫–∞—Ç
    removed_elements: List[Element]   # –î—É–±–ª–∏–∫–∞—Ç
    total_count: int                  # –î—É–±–ª–∏–∫–∞—Ç
    tokens_kept: int                  # –î—É–±–ª–∏–∫–∞—Ç
    tokens_removed: int               # –î—É–±–ª–∏–∫–∞—Ç
    nested_selections: Dict = ...     # –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ
    remaining_budget: int = 0         # –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ
    budget_exhausted: bool = False    # –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–¥–µ–ª–∏—Ç—å –æ–±—â—É—é –±–∞–∑—É:
```python
@dataclass
class SelectionBase:
    kept_elements: List[Element]
    removed_elements: List[Element]
    total_count: int
    tokens_kept: int
    tokens_removed: int

@dataclass
class Selection(SelectionBase):
    placeholder_index: int = -1

@dataclass
class DFSSelection(SelectionBase):
    nested_selections: Dict[int, DFSSelection] = field(default_factory=dict)
    remaining_budget: int = 0
    budget_exhausted: bool = False
```

---

## 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

### 2.1 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–û–¢–õ–ò–ß–ù–ê–Ø**

**–ß–∏—Å—Ç—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
```python
# code_base.py - –±–∞–∑–æ–≤—ã–π –∞–¥–∞–ø—Ç–µ—Ä
def create_literal_descriptor(self) -> Optional[LanguageLiteralDescriptor]:
    return None  # –ò–∑—è—â–Ω—ã–π fallback –¥–ª—è –Ω–µ-v2 —è–∑—ã–∫–æ–≤

# python/adapter.py - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —è–∑—ã–∫
def create_literal_descriptor(self) -> LanguageLiteralDescriptor:
    from .literals_v2 import create_python_descriptor
    return create_python_descriptor()

# core.py - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
descriptor = self.adapter.create_literal_descriptor()
if descriptor is None:
    self.handler = None  # –û—Ç–∫–ª—é—á–∏—Ç—å v2 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
    return
```

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å–∏—Å—Ç–µ–º–æ–π –±—é–¥–∂–µ—Ç–∞:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑—É–ø—Ä–µ—á–Ω–æ
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤:** ‚úÖ –£–≤–∞–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Token Service:** ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ adapter.tokenizer

**–ú–µ–ª–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - java/adapter.py:70:**
```python
def create_literal_descriptor(self):  # ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å `-> LanguageLiteralDescriptor` –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏

### 2.2 –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–∞–≤–æ–∫ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–•–û–†–û–®–û –°–ü–†–û–ï–ö–¢–ò–†–û–í–ê–ù–ê**

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è - range_edits.py:126-173:**
```python
def add_replacement_composing_nested(self, start, end, text, edit_type):
    """–ü—Ä–∏–º–µ–Ω–∏—Ç—å —à–∏—Ä–æ–∫—É—é –∑–∞–º–µ–Ω—É, —Å–æ—Ö—Ä–∞–Ω—è—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∫–∏."""
    # 1. –ù–∞–π—Ç–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∫–∏
    nested = [(i, e) for i, e in enumerate(self.edits)
              if self._contains(start, end, e)]

    if not nested:
        return self.add_edit(...)  # Fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π

    # 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∫ —à–∏—Ä–æ–∫–æ–º—É —Ç–µ–∫—Å—Ç—É
    composed_text = self._apply_nested_edits_to_text(text, nested)

    # 3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∑–∞–º–µ–Ω—É
    self.add_edit(EditOp.REPLACE, start, end, composed_text, edit_type)
```

**–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:** ‚úÖ **–í–°–ï–°–¢–û–†–û–ù–ù–ï–ï**
- 5 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –≤ `test_range_edits_nested.py`
- –í—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ü–æ–∫—Ä—ã–≤–∞–µ—Ç: –µ–¥–∏–Ω–∏—á–Ω–æ–µ –≤–ª–æ–∂–µ–Ω–Ω–æ–µ, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–ª–æ–∂–µ–Ω–Ω–æ–µ, –±–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π, —á–∞—Å—Ç–∏—á–Ω–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

**1. –†–∏—Å–∫ –∫–æ–ª–ª–∏–∑–∏–∏ –ø–æ–¥—Å—Ç—Ä–æ–∫ - range_edits.py:233:**
```python
if original_substr in result:
    pos = result.rfind(original_substr)  # –ú–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ!
```

**–í–ª–∏—è–Ω–∏–µ:** –ù–∏–∑–∫–æ–µ (DFS –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã), –Ω–æ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
**–ü—Ä–∏–º–µ—Ä:** `"value": "test", "value": "test"` –º–æ–∂–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å—Å—è —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫

**2. –ú–∞–≥–∏—á–µ—Å–∫–æ–µ —á–∏—Å–ª–æ - range_edits.py:218:**
```python
if end <= ins_pos <= end + 10:  # ‚ö†Ô∏è –ñ—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å
```

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º

### 2.3 –ü—Ä–æ–±–ª–µ–º—ã –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

#### –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: üü° **–•–û–†–û–®–ê–Ø –° –ü–†–û–ë–ï–õ–ê–ú–ò**

**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏:**
- `formatter.py:325` - –ø–∞—Ä–∞–º–µ—Ç—Ä `elem` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `Element`)
- `java/adapter.py:70` - —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞
- `range_edits.py:178` - –Ω–µ—è—Å–Ω–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ç–µ–∂–∞

**–•–æ—Ä–æ—à–∏–µ –ø—Ä–∏–º–µ—Ä—ã:**
```python
def select_dfs(
    self,
    elements: List[Element],
    budget: int,
    parser: ElementParser,
    min_keep: int = 1,
    tuple_size: int = 1,
) -> DFSSelection:  # ‚úÖ –ü–æ–ª–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
```

#### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞: üî¥ **–í–´–°–û–ö–û–ï (~300 –°–¢–†–û–ö)**

**formatter.py - –ö—Ä—É–ø–Ω–æ–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:**

- `_format_single_line_dfs()` (151-206) vs `_format_single_line()` (443-485)
- `_format_multiline_dfs()` (208-279) vs `_format_multiline()` (487-543)

**90% –∏–¥–µ–Ω—Ç–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤—ã–±–æ—Ä–æ–∫

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–¥–µ–ª–∏—Ç—å –æ–±—â–µ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
```python
def _format_single_line(self, parsed, selection, placeholder):
    if isinstance(selection, DFSSelection):
        return self._format_single_line_dfs(parsed, selection, placeholder)
    return self._format_single_line_flat(parsed, selection, placeholder)

def _format_single_line_flat(self, parsed, selection, placeholder):
    # –í—ã–¥–µ–ª–µ–Ω–Ω–∞—è –æ–±—â–∞—è –ª–æ–≥–∏–∫–∞
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: üî¥ **–û–¢–°–£–¢–°–¢–í–£–ï–¢**

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–±–µ–ª:**
```bash
$ grep -r "except|raise|try:" lg/adapters/optimizations/literals_v2
# –°–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ - –ù–û–õ–¨ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫!
```

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞:**
1. `parser.py:112-189` - –¶–∏–∫–ª –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∫ (–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥)
2. `handler.py:659-703` - –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∫–æ–±–æ–∫ (—Ä–∏—Å–∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞)
3. `selector.py:336-453` - DFS —Ä–µ–∫—É—Ä—Å–∏—è (—Ä–∏—Å–∫ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç–µ–∫–∞)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```python
# –í selector.py
MAX_DFS_DEPTH = 10

def select_dfs(self, elements, budget, parser, depth=0):
    if depth > MAX_DFS_DEPTH:
        raise RecursionError(f"DFS exceeded max depth {MAX_DFS_DEPTH}")
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
```

### 2.4 –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞**

**selector.py - 200+ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤:**
```python
# –°—Ç—Ä–æ–∫–∞ 391 - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –ö–ê–ñ–î–û–ì–û —ç–ª–µ–º–µ–Ω—Ç–∞
elem_original_tokens = self.tokenizer.count_text(elem.text)

# –°—Ç—Ä–æ–∫–∞ 442 - –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
tokens_removed = sum(self.tokenizer.count_text(e.text) for e in removed)
```

**–í–ª–∏—è–Ω–∏–µ:**
- –î–ª—è –º–∞—Å—Å–∏–≤–∞ –∏–∑ 100 —ç–ª–µ–º–µ–Ω—Ç–æ–≤: 200+ –≤—ã–∑–æ–≤–æ–≤ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞
- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –∫–æ–¥–∏—Ä—É–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç tiktoken
- 10x –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –±–æ–ª—å—à–∏—Ö –ª–∏—Ç–µ—Ä–∞–ª–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:** –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ Element:
```python
@dataclass
class Element:
    text: str
    _token_count: Optional[int] = None

    def get_token_count(self, tokenizer):
        if self._token_count is None:
            self._token_count = tokenizer.count_text(self.text)
        return self._token_count
```

#### üü° **–£–º–µ—Ä–µ–Ω–Ω–æ: O(n¬≤) –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏**

**core.py:115-119:**
```python
for i, (node, capture_name) in enumerate(collections):
    is_nested = any(
        j != i and
        collections[j][0].start_byte <= start_byte and
        collections[j][0].end_byte >= end_byte
        for j in range(len(collections))  # O(n¬≤)
    )
```

**–í–ª–∏—è–Ω–∏–µ:** 1000 –ª–∏—Ç–µ—Ä–∞–ª–æ–≤ ‚Üí 1M —Å—Ä–∞–≤–Ω–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –¥–ª—è O(n log n):
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ + –±–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫
sorted_collections = sorted(collections, key=lambda x: (x[0].start_byte, -x[0].end_byte))
# –ë–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
```

#### ‚úÖ **–•–æ—Ä–æ—à–æ: –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**

**handler.py:90-103:**
```python
def get_parser(self, pattern: LiteralPattern) -> ElementParser:
    key = f"{pattern.separator}:{pattern.kv_separator}"
    if key not in self._parsers:
        self._parsers[key] = ElementParser(config)  # –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
    return self._parsers[key]
```

---

## 3. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –Ø–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ –≤ Handler **[–ò–°–ü–†–ê–í–õ–ï–ù–û]**

**–§–∞–π–ª:** `handler.py:539-550`
**–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å:** –í–´–°–û–ö–ê–Ø - –ù–∞—Ä—É—à–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 2 —á–∞—Å–∞ ‚Üí **–§–∞–∫—Ç–∏—á–µ—Å–∫–∏: 1.5 —á–∞—Å–∞**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û 2025-12-04**

**–ü—Ä–æ–±–ª–µ–º–∞:** Handler —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `if self.language == "python"`

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å callback `interpolation_active` –≤ `LiteralPattern`

**–í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ `categories.py` - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `interpolation_active: Optional[Callable[[str, str], bool]]`
- ‚úÖ `handler.py` - –∑–∞–º–µ–Ω–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ `self.language ==` –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ callback
- ‚úÖ `python/literals_v2.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_is_f_string()` –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
- ‚úÖ JavaScript/TypeScript - –º–∞—Ä–∫–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (self-checking —á–µ—Ä–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å `$`)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ Python: 21/21 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏
- ‚úÖ JavaScript: 19/19 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏
- ‚úÖ TypeScript: 17/17 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏
- ‚úÖ Java: 4/4 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—à–ª–∏
- **–í—Å–µ–≥–æ:** 59/59 —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ Handler –±–æ–ª—å—à–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —è–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
- ‚úÖ –Ø–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞—Ö
- ‚úÖ –ù–æ–≤—ã–µ —è–∑—ã–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ callback –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π —è–¥—Ä–∞

### ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∞ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ **[–ò–°–ü–†–ê–í–õ–ï–ù–û]**

**–§–∞–π–ª:** `selector.py`, `formatter.py`, `handler.py`, `core.py`
**–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å:** –í–´–°–û–ö–ê–Ø - 10x –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 30 –º–∏–Ω—É—Ç ‚Üí **–§–∞–∫—Ç–∏—á–µ—Å–∫–∏: 20 –º–∏–Ω—É—Ç**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û 2025-12-04**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ `tokenizer.count_text_cached()` –≤–º–µ—Å—Ç–æ `count_text()`

**–í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ `selector.py` - 9 –∑–∞–º–µ–Ω –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–∏–∫–ª–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ `formatter.py` - 1 –∑–∞–º–µ–Ω–∞ –≤ —Ä–∞—Å—á—ë—Ç–µ –∏—Ç–æ–≥–æ–≤—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ `handler.py` - 4 –∑–∞–º–µ–Ω—ã –≤ –ø–∞—Ä—Å–∏–Ω–≥–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å—Ç—Ä–æ–∫
- ‚úÖ `core.py` - 2 –∑–∞–º–µ–Ω—ã –≤ –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö –±—é–¥–∂–µ—Ç–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ 59/59 —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ (Python, JS, TS, Java)
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞ (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ TokenService)
- ‚úÖ –õ–æ–≥–∏–∫–∞ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ Formatter

**–§–∞–π–ª:** `formatter.py:151-543`
**–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å:** –°–†–ï–î–ù–Ø–Ø - –ë—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 2 —á–∞—Å–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** ~300 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É DFS –∏ –ø–ª–æ—Å–∫–∏–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–¥–µ–ª–∏—Ç—å –æ–±—â–∏–µ –±–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `formatter.py` - —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤ –±–∞–∑–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ Selection

**–§–∞–π–ª:** `selector.py:18-104`
**–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å:** –°–†–ï–î–ù–Ø–Ø - –ù–∞—Ä—É—à–µ–Ω–∏–µ DRY
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 1 —á–∞—Å

**–ü—Ä–æ–±–ª–µ–º–∞:** 90% –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π –º–µ–∂–¥—É `Selection` –∏ `DFSSelection`

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å `SelectionBase` —Å –æ–±—â–∏–º–∏ –ø–æ–ª—è–º–∏

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `selector.py` - –¥–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–§–∞–π–ª—ã:** –í—Å–µ –º–æ–¥—É–ª–∏ literals_v2
**–°–µ—Ä—å—ë–∑–Ω–æ—Å—Ç—å:** –°–†–ï–î–ù–Ø–Ø - –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏
**–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:** 1 —á–∞—Å

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –±–ª–æ–∫–æ–≤ try/except –Ω–∏–≥–¥–µ

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `parser.py` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö —Å—Ç—Ä–æ–∫
- `selector.py` - –¥–æ–±–∞–≤–∏—Ç—å –ª–∏–º–∏—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≥–ª—É–±–∏–Ω—ã
- `handler.py` - –¥–æ–±–∞–≤–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è —Ü–∏–∫–ª–æ–≤

---

## 4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ (–ü–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –º–∏–≥—Ä–∞—Ü–∏–µ–π)

1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å —è–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ handler** (2 —á–∞—Å–∞)
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç —á–∏—Å—Ç—É—é –º–∏–≥—Ä–∞—Ü–∏—é Kotlin/Scala

2. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞** (30 –º–∏–Ω)
   - –í—ã—Å–æ–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
   - –ü—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–π –ø–æ–ª—å–∑–æ–π

3. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ª–∏–º–∏—Ç—ã —Ä–µ–∫—É—Ä—Å–∏–∏** (15 –º–∏–Ω)
   - –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞

### –ü–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º —Ä–µ–ª–∏–∑–æ–º

4. ‚ö° **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è formatter** (2 —á–∞—Å–∞)
   - –ë—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - –†–∏—Å–∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –±–∞–≥–æ–≤

5. ‚ö° **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –∫–ª–∞—Å—Å—ã Selection** (1 —á–∞—Å)
   - –ü—Ä–∏–Ω—Ü–∏–ø DRY
   - –ë–æ–ª–µ–µ —á–∏—Å—Ç–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è

6. ‚ö° **–î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫** (1 —á–∞—Å)
   - –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
   - –õ—É—á—à–∞—è –æ—Ç–ª–∞–¥–∫–∞

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ

7. üí° **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏** (1 —á–∞—Å)
   - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
   - O(n¬≤) ‚Üí O(n log n)

8. üí° **–ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞** (15 –º–∏–Ω)
   - `tolerance = 10` –≤ range_edits
   - –£–ª—É—á—à–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å

9. üí° **–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π** (30 –º–∏–Ω)
   - –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–≤—É—Ö–ø—Ä–æ—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
   - –û–±—ä—è—Å–Ω–∏—Ç—å Selection vs DFSSelection

---

## 5. –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏ ‚úÖ

| –Ø–∑—ã–∫ | –°—Ç—Ä–æ–∫ | –¢–µ—Å—Ç—ã | –°—Ç–∞—Ç—É—Å |
|----------|-------|-------|--------|
| Python | 152 | 19/21 ‚úÖ | –ì–û–¢–û–í–û |
| JavaScript | 118 | 19/19 ‚úÖ | –ì–û–¢–û–í–û |
| TypeScript | 124 | 17/17 ‚úÖ | –ì–û–¢–û–í–û |
| Java | 122 | 4/4 ‚úÖ | –ì–û–¢–û–í–û |

**–ò—Ç–æ–≥–æ:** 516 —Å—Ç—Ä–æ–∫ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ (vs 1200+ —Å—Ç—Ä–æ–∫ –≤ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏)

### –û—Å—Ç–∞–≤—à–∏–µ—Å—è —è–∑—ã–∫–∏ ‚è∏Ô∏è

| –Ø–∑—ã–∫ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ë–ª–æ–∫–µ—Ä—ã | –û—Ü–µ–Ω–∫–∞ |
|----------|-----------|----------|----------|
| Kotlin | –°—Ä–µ–¥–Ω—è—è | –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è (`${}`, `$var`) | 4 —á–∞—Å–∞ |
| Scala | –°—Ä–µ–¥–Ω—è—è | –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è (`${}`, `$var`) | 4 —á–∞—Å–∞ |
| Go | –ù–∏–∑–∫–∞—è | –ë–µ–∑ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ | 2 —á–∞—Å–∞ |
| Rust | –í—ã—Å–æ–∫–∞—è | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ format-—Å—Ç—Ä–æ–∫ –Ω–µ–Ω–∞–¥—ë–∂–Ω–æ | 6 —á–∞—Å–æ–≤ |
| C | –ù–∏–∑–∫–∞—è | –ë–µ–∑ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ | 2 —á–∞—Å–∞ |
| C++ | –°—Ä–µ–¥–Ω—è—è | –°–ø–∏—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤ | 3 —á–∞—Å–∞ |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 21 —á–∞—Å

### –ü—É—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

**–§–∞–∑–∞ 1:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (3 —á–∞—Å–∞)
1. –Ø–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ handler
2. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞
3. –õ–∏–º–∏—Ç—ã —Ä–µ–∫—É—Ä—Å–∏–∏

**–§–∞–∑–∞ 2:** –Ø–∑—ã–∫–∏ –Ω–∏–∑–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (4 —á–∞—Å–∞)
1. Go (—Å–æ—Å—Ç–∞–≤–Ω—ã–µ –ª–∏—Ç–µ—Ä–∞–ª—ã)
2. C (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –º–∞—Å—Å–∏–≤–æ–≤)

**–§–∞–∑–∞ 3:** –°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (11 —á–∞—Å–æ–≤)
1. C++ (—Å–ø–∏—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤ + —à–∞–±–ª–æ–Ω—ã)
2. Kotlin (—Ñ–∞–±—Ä–∏—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã + –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è)
3. Scala (—Ñ–∞–±—Ä–∏—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã + –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è)

**–§–∞–∑–∞ 4:** –í—ã—Å–æ–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å (6 —á–∞—Å–æ–≤)
1. Rust (–≤—ã–∑–æ–≤—ã –º–∞–∫—Ä–æ—Å–æ–≤ + format-—Å—Ç—Ä–æ–∫–∏)

**–§–∞–∑–∞ 5:** –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (3 —á–∞—Å–∞)
1. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ formatter
2. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ Selection
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ò—Ç–æ–≥–æ:** ~27 —á–∞—Å–æ–≤ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö 10 —è–∑—ã–∫–æ–≤

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã v2 ‚úÖ

1. **–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É—Å—Ç—Ä–∞–Ω—è—é—Ç –∫–æ–¥**
   - –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã 50-150 —Å—Ç—Ä–æ–∫ vs 300+ –≤ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏
   - –ù–µ –Ω—É–∂–Ω—ã –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ö—É–∫–∏

2. **–Ø–∑—ã–∫–æ-–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–æ–µ —è–¥—Ä–æ** (—Å –æ–¥–Ω–∏–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º)
   - –ß–∏—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
   - –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π —è–¥—Ä–∞

3. **–ì–∏–±–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤**
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è END, MIDDLE_COMMENT, INLINE
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

4. **–î–≤—É—Ö–ø—Ä–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —Å –∫–æ–º–ø–æ–∑–∏—Ä—É–µ–º—ã–º–∏ –ø—Ä–∞–≤–∫–∞–º–∏**
   - –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ + –∫–æ–ª–ª–µ–∫—Ü–∏–π
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫

5. **DFS –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä**
   - –†–µ–∫—É—Ä—Å–∏—è —Å —É—á—ë—Ç–æ–º –±—é–¥–∂–µ—Ç–∞
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–µ–ª—ã ‚ö†Ô∏è

1. –Ø–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ –≤ handler (–Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã)
2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ (10x –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
3. 300 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. –ù—É–ª–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (—Ä–∏—Å–∫ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏)
5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–∏–º–∏—Ç–æ–≤ —Ä–µ–∫—É—Ä—Å–∏–∏ (—Ä–∏—Å–∫ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç–µ–∫–∞)

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞–¥—ë–∂–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** —Å —Ü–µ–ª–µ–≤—ã–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏.

**–û—Ü–µ–Ω–∫–∞:** B+ (–û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ 1-3 (~3 —á–∞—Å–∞)
2. ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —è–∑—ã–∫–æ–≤
3. ‚ö° –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4-6 –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º —Ä–µ–ª–∏–∑–æ–º
4. üí° –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø–æ –º–µ—Ä–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç–∏–≥ —Å–≤–æ–∏—Ö —Ü–µ–ª–µ–π –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ—á–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è 6 —è–∑—ã–∫–æ–≤.

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –°–≤–æ–¥–∫–∞ –ø–æ —Ñ–∞–π–ª–∞–º

### –ú–æ–¥—É–ª–∏ —è–¥—Ä–∞

| –§–∞–π–ª | –°—Ç—Ä–æ–∫ | –û—Ü–µ–Ω–∫–∞ | –ü—Ä–æ–±–ª–µ–º—ã |
|------|-------|-------|--------|
| categories.py | 170 | A | –ù–µ—Ç |
| descriptor.py | 67 | A | –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å—Ç–∏–ª—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å—é–¥–∞ |
| parser.py | 382 | A- | –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ |
| selector.py | 554 | B+ | –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ DFS |
| formatter.py | 628 | B | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (~300 —Å—Ç—Ä–æ–∫) |
| handler.py | 703 | B- | –Ø–∑—ã–∫-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥ |
| core.py | 310 | A- | O(n¬≤) –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å |

### –Ø–∑—ã–∫–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã

| –§–∞–π–ª | –°—Ç—Ä–æ–∫ | –û—Ü–µ–Ω–∫–∞ | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|------|-------|-------|-------|
| python/literals_v2.py | 152 | A | –ß–∏—Å—Ç–æ, –ø–æ–ª–Ω–æ—Å—Ç—å—é |
| javascript/literals_v2.py | 118 | A | –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã |
| typescript/literals_v2.py | 124 | A | –•–æ—Ä–æ—à–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç JS |
| java/literals_v2.py | 122 | A | –§–∞–±—Ä–∏—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã |

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

| –§–∞–π–ª | –°—Ç—Ä–æ–∫ | –û—Ü–µ–Ω–∫–∞ | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|------|-------|-------|-------|
| range_edits.py | +130 | A- | –†–∏—Å–∫ –∫–æ–ª–ª–∏–∑–∏–∏ –ø–æ–¥—Å—Ç—Ä–æ–∫ |
| code_base.py | +20 | A | –ß–∏—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è |

---

**–†–µ–≤—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ:** 2025-12-04
**–°–ª–µ–¥—É—é—â–µ–µ —Ä–µ–≤—å—é:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ 1-3
