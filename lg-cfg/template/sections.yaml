tags:
  tag-sets:
    template-features:
      title: "Template engine features"
      tags:
        core:
          title: "Core"
        addressing:
          title: "Path resolution and addressing system"
        common-placeholders:
          title: "Section and template placeholders"
        adaptive:
          title: "Adaptive capabilities"
        md-placeholders:
          title: "Markdown placeholder"
        conditions:
          title: "Conditional expressions"
        task-placeholder:
          title: "Task placeholder"

src:
  extends: ["tags"]
  extensions: [".py", ".toml"]
  filters:
    mode: allow
    allow:
      - "/pyproject.toml"
      - "/lg/"
    children:
      lg:
        mode: allow
        allow:
          - "/cli.py"
          - "/types.py"
          - "/run_context.py"
          - "/engine.py"
          - "/section_processor.py"
          - "/section/"
          - "/adapters/"
          - "/template/"
        when:
          - condition: "TAGSET:template-features:conditions"
            allow: ["/conditions/"]
          - condition: "TAGSET:template-features:addressing"
            allow: ["/addressing/"]
        children:
          section:
            mode: allow
            allow: ["/service.py"]
          adapters:
            mode: allow
            allow:
              - "/__init__.py"
              - "/registry.py"
              - "/base.py"
              - "/processor.py"
              - "/markdown.py"
          template:
            mode: allow
            allow:
              - "/*.py"
            when:
              - condition: "TAGSET:template-features:common-placeholders"
                allow: ["/common_placeholders/"]
              - condition: "TAGSET:template-features:adaptive"
                allow: ["/adaptive/"]
              - condition: "TAGSET:template-features:md-placeholders"
                allow: ["/md_placeholders/"]
              - condition: "TAGSET:template-features:task-placeholder"
                allow: ["/task_placeholder/"]

tests:
  extends: ["tags"]
  extensions: [".py"]
  filters:
    mode: allow
    allow:
      - "/tests/"
    children:
      tests:
        mode: allow
        allow:
          - "/template/"
        when:
          - condition: "tag:tests-infra"
            allow:
              - "/conftest.py"
              - "/infrastructure/"
        children:
          template:
            mode: allow
            when:
              - condition: "TAGSET:template-features:common-placeholders"
                allow: ["/common_placeholders/"]
              - condition: "TAGSET:template-features:adaptive"
                allow: ["/adaptive/"]
              - condition: "TAGSET:template-features:md-placeholders"
                allow: ["/md_placeholders/"]
              - condition: "TAGSET:template-features:task-placeholder"
                allow: ["/task_placeholder/"]
  tag-sets:
    code-type:
      title: "Code Type"
      tags:
        tests-infra:
          title: "Test infrastructure"
