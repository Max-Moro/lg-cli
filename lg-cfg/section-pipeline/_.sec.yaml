src:
  extensions: [".py", ".toml"]
  filters:
    mode: allow
    allow:
      - "/pyproject.toml"
      - "/lg/"
    children:
      lg:
        mode: allow
        allow:
          - "/cli.py"
          - "/engine.py"
          - "/types.py"
          - "/run_context.py"
          - "/template/context.py"
          - "/section_processor.py"
          - "/config/"
          - "/filtering/manifest.py"
        when:
          - condition: "TAGSET:section-pipeline:filtering"
            allow: ["/filtering/"]
          - condition: "TAGSET:section-pipeline:rendering"
            allow: ["/rendering/"]
        children:
          config:
            mode: allow
            allow:
              - "/load.py"
              - "/model.py"


tests:
  extensions: [".py"]
  path_labels: relative
  filters:
    mode: allow
    allow:
      - "/tests/"
    children:
      tests:
        mode: allow
        when:
          - condition: "tag:tests-infra"
            allow:
              - "conftest.py"
              - "/infrastructure/"
          - condition: "TAGSET:section-pipeline:filtering"
            allow: ["/test_filters_engine.py"]
          - condition: "TAGSET:section-pipeline:rendering"
            allow: ["/test_path_labels.py"]
